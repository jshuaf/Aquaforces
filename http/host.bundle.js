!function(e){function t(s){if(r[s])return r[s].exports;var a=r[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([/*!****************************!*\
  !*** ./http/host/host.jsx ***!
  \****************************/
function(e,t,r){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function a(e){u.children.forEach(function(t){t.id!=e&&(t.hidden=!0)}),document.getElementById(e).hidden=!1}function n(){var e=this.dataset.username;d.send(JSON.stringify({event:"removeUser",user:e})),this.parentNode.removeChild(this);for(var t=0;t<h.length;t++){var r=h[t];if(e==r){h.splice(h.indexOf(r),1);break}}}function i(){if(!w){d.send(JSON.stringify({event:"removeUserFromCrew",user:this.dataset.username}));var e=document.createElement("li");e.dataset.username=this.dataset.username,e.appendChild(document.createTextNode(this.dataset.username)),e.onclick=n,document.getElementById("loneusers").appendChild(e),this.parentNode.dataset.n--,this.parentNode.removeChild(this);for(var t in m){var r=m[t].users,s=!0,a=!1,i=void 0;try{for(var o,c=r[Symbol.iterator]();!(s=(o=c.next()).done);s=!0){var l=o.value;if(l==this.dataset.username)return void r.splice(r.indexOf(l),1)}}catch(u){a=!0,i=u}finally{try{!s&&c["return"]&&c["return"]()}finally{if(a)throw i}}}}}function o(){d.send(JSON.stringify({event:"messageRecieved"}))}var c=r(/*! ./GameHost.jsx */1),l=s(c),d=new WebSocket(("http:"===location.protocol?"ws://":"wss://")+location.hostname+(80!=location.port?":"+location.port:"")+"/host/"),u=document.getElementById("cont"),m={},h=[],p=void 0,w=!1;d.onmessage=function(e){try{e=JSON.parse(e.data)}catch(t){return console.log(t),sweetAlert("Socket error.","error")}switch(o(),e.event){case"ping":break;case"error":sweetAlert(e.title,e.text,"error");break;case"newGame":document.getElementById("game-code-cont").appendChild(document.createTextNode(e.id)),a("tgame");break;case"addNewUser":var r=document.createElement("li");r.dataset.username=e.user,r.appendChild(document.createTextNode(e.user)),r.onclick=n,document.getElementById("loneusers").appendChild(r),h.push(e.user);break;case"addUserToCrew":document.getElementById("loneusers").childNodes.forEach(function(t){t.firstChild.nodeValue==e.user&&t.parentNode.removeChild(t)});var s=document.createElement("span");s.dataset.username=e.user,s.className="clickable pill",s.onclick=i,s.appendChild(document.createTextNode(e.user)),document.getElementById("crews").children[e.crew-1].appendChild(s),document.getElementById("crews").children[e.crew-1].dataset.n++,e.crew in m?m[e.crew].users.push(e.user):m[e.crew]={name:"Crew "+e.crew.toString(),users:[e.user],position:0,status:"rowing",boat:"canoe"};break;case"startGame":document.getElementById("cont").hidden=!0,a("mountNode"),w=!0,p=ReactDOM.render(React.createElement(l["default"],{initialCrews:m}),document.getElementById("mountNode"));break;case"answerSelected":p.answerSelected(e.wasCorrectAnswer,e.crewNumber);break;case"whirlpoolStatusChanged":p.whirlpoolStatusChanged(e.status,e.crewNumber);break;case"removeUser":var t=document.querySelector("[data-username="+JSON.stringify(e.user)+"]");t&&t.parentNode.removeChild(t)}},d.onclose=function(){sweetAlert("Server connection died.","We're sorry about that.","error")},document.getElementById("dashboard").addEventListener("submit",function(e){document.getElementById("newGameButton").disabled=!0,e.preventDefault(),d.send(JSON.stringify({event:"newGame"}))}),document.getElementById("startGameButton").addEventListener("click",function(e){document.getElementById("startGameButton").disabled=!0,e.preventDefault(),d.send(JSON.stringify({event:"startGame"}))})},/*!********************************!*\
  !*** ./http/host/GameHost.jsx ***!
  \********************************/
function(e,t,r){"use strict";var s=r(!function(){var e=new Error('Cannot find module "react"');throw e.code="MODULE_NOT_FOUND",e}()),a=(s.createClass({displayName:"GameHost",getInitialState:function(){return{gameStatus:"hasNotStarted",startTime:new Date,crews:this.props.initialCrews}},answerSelected:function(e,t){var r=this.refs[t.toString()];e&&this.updateCrewPosition(t,.1),r.processAnswer(e)},updateCrewPosition:function(e,t){var r=this.state.crews;r[e].position+=t,this.setState({crews:r})},updateCrewStatus:function(e,t){var r=this.state;r.crews[e].props.status=t,this.setState(r)},updateCrewBoat:function(e,t){var r=this.state;r.crews[e].props.boat=t,this.setState(r)},whirlpoolStatusChanged:function(e,t){var r=this.refs[t.toString()];r.processWhirlpool(e)},render:function(){return s.createElement("div",{className:"container"},s.createElement("div",{className:"row"},s.createElement("div",{className:"three columns"},s.createElement("div",{className:"panel"},s.createElement(n,{crews:this.state.crews}))),s.createElement("div",{className:"nine columns"},s.createElement("div",{className:"panel"},s.createElement("h4",null,s.createElement("strong",null,"Live stream")),Object.keys(this.state.crews).map(function(e,t){var r=this.state.crews[e];return s.createElement(a,{position:r.position,status:r.status,boat:r.boat,size:r.users.length,crewNumber:e,key:t,ref:e.toString()})}.bind(this))))))}}),s.createClass({displayName:"Crew",getInitialState:function(){return{velocity:0,deltaVelocity:10,maximumDeltaVelocity:10,hp:1,current:-.1,isRaft:!1,isWhirlpool:!1}},getDefaultProps:function(){return{currentConstant:.003,velocityConstant:1e-5,deltaHPConstant:-.1}},processWhirlpool:function(e){switch(e){case"new":this.setState({isWhirlpool:!0});break;case"timeout":this.setState({hp:this.state.hp-.25,isWhirlpool:!1});break;case"wrongAnswer":this.setState({hp:this.state.hp-.25,isWhirlpool:!1});break;case"correctAnswer":this.setState({position:this.state.position+.3,isWhirlpool:!1})}},processAnswer:function(e){e?this.setState({velocity:this.state.velocity+this.state.deltaVelocity}):this.state.isRaft?this.setState({deltaVelocity:.25*this.state.deltaVelocity}):(this.setState({hp:this.state.hp+this.props.deltaHPConstant}),!this.state.isRaft&&this.state.hp<=0&&this.setState({isRaft:!0}))},render:function(){var e={width:"10rem",marginLeft:100*this.props.position+"px",borderRadius:"5px",border:"none",background:"url(/img/boats-side/"+(this.state.isRaft?"rafts":"canoes")+"/"+this.props.size+"-members.svg) no-repeat center top"},t=this.state.isRaft?"raft":"racetrack-boat";return s.createElement("div",{className:t,style:e},s.createElement("p",null,"Crew ",this.props.crewNumber))}})),n=s.createClass({displayName:"Leaderboard",render:function(){return s.createElement("div",null,s.createElement("h4",null,s.createElement("strong",null,"Leaderboard")),Object.keys(this.props.crews).map(function(e,t){var r=this.props.crews[e];return s.createElement(i,{crewNumber:e,crewPosition:r.position,key:t})}.bind(this)))}}),i=s.createClass({displayName:"LeaderboardEntry",render:function(){var e={fontSize:15*(this.props.crewPosition+1)+"px",padding:5+this.props.crewPosition+"px"};return s.createElement("div",{className:"leaderboardEntry"},s.createElement("h5",null,"Crew ",this.props.crewNumber,": ",s.createElement("span",{style:e,className:"pill"},Math.round(10*this.props.crewPosition)/10)))}})}]);
//# sourceMappingURL=host.bundle.js.map